<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Recipes</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Special+Elite&display=swap');

        body {
            font-family: 'Special Elite', cursive;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #f8f8f8;
        }

        .receipt {
            width: 300px;
            background: white;
            padding: 20px;
            border: 2px solid black;
            box-shadow: 5px 5px 0px black;
            text-align: center;
        }

        h2 {
            font-size: 22px;
            border-bottom: 2px dashed black;
            padding-bottom: 5px;
            margin-bottom: 10px;
        }

        .ingredient {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            font-size: 18px;
            background: white;
            border: 2px solid black;
            cursor: pointer;
            font-family: 'Special Elite', cursive;
        }

        .ingredient:hover {
            background: #ddd;
        }

        .selected {
            background: #bbb;
            cursor: default;
        }

        #changeChoices {
            background-color: #ff6666;
        }

        #changeChoices:hover {
            background-color: #ff4444;
        }

        #selectionHint {
            font-style: italic;
            margin-top: 10px;
        }

        #unlockedRecipes {
            margin-top: 15px;
            font-size: 16px;
            padding-top: 10px;
            border-top: 2px dashed black;
            text-align: left;
        }

        ul {
            list-style-type: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="receipt">
        <h2>ðŸ›’ Grocery Receipt</h2>
        <p id="availableIngredients">Loading ingredients...</p>
        <div id="ingredientButtons"></div>
        <button id="changeChoices" class="ingredient" onclick="loadFirstChoices()">ðŸ”„ Change Choices</button>

        <p id="selectionHint" style="display: none;">Now choose the second ingredient!</p>

        <div id="secondChoiceContainer"></div>

        <p id="message"></p>

        <div id="unlockedRecipes" style="display: none;">
            <strong>Unlocked Recipes:</strong>
            <ul id="recipeList"></ul>
        </div>
    </div>

    <script>
        const allIngredients = ["egg", "milk", "leek", "dandelion", "cheese", "pepper", "vinegar"];
        const recipes = {
            "egg,milk": "Omelet",
            "dandelion,leek": "Salad",
            "milk,milk": "Cheese",
            "pepper,vinegar": "Pepper Poppers",
            "egg,egg": "Fried Egg"
        };

        let selectedIngredient = null;
        let unlockedRecipes = [];

        function loadFirstChoices() {
            let availableIngredients = allIngredients.sort(() => 0.5 - Math.random()).slice(0, 3);
            document.getElementById("availableIngredients").innerText = `You have: ${availableIngredients.join(", ")}`;

            const container = document.getElementById("ingredientButtons");
            container.innerHTML = "";
            availableIngredients.forEach(ingredient => {
                let button = document.createElement("button");
                button.innerText = ingredient;
                button.className = "ingredient";
                button.onclick = () => selectFirstIngredient(ingredient, button);
                container.appendChild(button);
            });

            document.getElementById("selectionHint").style.display = "none";
            document.getElementById("secondChoiceContainer").innerHTML = "";
            document.getElementById("message").innerText = "";
            selectedIngredient = null;
        }

        function selectFirstIngredient(ingredient, button) {
            selectedIngredient = ingredient;
            button.classList.add("selected"); // æ ‡è®°å·²é€‰
            button.onclick = null; // ç¦æ­¢å†æ¬¡ç‚¹å‡»

            document.getElementById("selectionHint").style.display = "block";

            loadSecondChoices(ingredient);
        }

        function loadSecondChoices(firstIngredient) {
            let validPairings = Object.keys(recipes).filter(pair => pair.includes(firstIngredient));
            let correctSecondIngredient = validPairings.length > 0 ? validPairings[0].replace(firstIngredient, "").replace(",", "") : null;

            let otherChoices = allIngredients.filter(i => i !== firstIngredient && i !== correctSecondIngredient)
                                            .sort(() => 0.5 - Math.random()).slice(0, 2);

            let secondChoices = correctSecondIngredient ? [correctSecondIngredient, ...otherChoices].sort(() => 0.5 - Math.random()) : otherChoices.slice(0, 3);

            const container = document.getElementById("secondChoiceContainer");
            container.innerHTML = "";

            secondChoices.forEach(ingredient => {
                let button = document.createElement("button");
                button.innerText = ingredient;
                button.className = "ingredient";
                button.onclick = () => checkRecipe(selectedIngredient, ingredient);
                container.appendChild(button);
            });
        }

        function checkRecipe(ingredient1, ingredient2) {
            let pair = [ingredient1, ingredient2].sort().join(",");
            let recipeName = recipes[pair];

            if (recipeName) {
                document.getElementById("message").innerText = `âœ… You made ${recipeName}!`;

                if (!unlockedRecipes.includes(`${ingredient1} + ${ingredient2} = ${recipeName}`)) {
                    unlockedRecipes.push(`${ingredient1} + ${ingredient2} = ${recipeName}`);
                    updateUnlockedRecipes();
                }
            } else {
                document.getElementById("message").innerText = "âŒ No recipe found.";
            }
        }

        function updateUnlockedRecipes() {
            const list = document.getElementById("recipeList");
            list.innerHTML = "";
            unlockedRecipes.forEach(recipe => {
                let li = document.createElement("li");
                li.innerText = recipe;
                list.appendChild(li);
            });

            document.getElementById("unlockedRecipes").style.display = "block";
        }

        loadFirstChoices();
    </script>
</body>
</html>